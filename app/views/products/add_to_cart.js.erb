<% item = current_cart.find_item_by(@product) %>
<% cart = current_cart %>
<% if item_only_one?(item) %>
  $('.item-list').append('<%= j render partial: "shared/item", locals: { item: item } %>');
  $('#cart-button').empty().append('<%= link_to "View Cart", cart_path(current_cart), class: "btn btn-default" %>');
<% else %>
  $('.cart-<%= @product.id %>-qty').text("<%= item.quantity %>");
<% end %>

$('.amount').text('<%= current_cart.subtotal %>');
